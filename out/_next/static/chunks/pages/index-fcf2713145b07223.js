(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(775)}])},775:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return k}});var s=t(5893),i=t(7294),r=t(7172),n=e=>{let{player:a}=e,[t,r]=(0,i.useState)(0);return(0,i.useEffect)(()=>{if(!a)return;let e=()=>{r(a.timer.position/a.video.duration*100)};return a.addListener({onTimeUpdate:e}),()=>{a.removeListener({onTimeUpdate:e})}},[a]),(0,s.jsx)("div",{className:"seek-bar",children:(0,s.jsx)("input",{type:"range",min:"0",max:"100",value:t,onChange:e=>{if(a){let t=Number(e.target.value)/100*a.video.duration;a.requestMediaSeek(t)}},className:"seek-bar__input",style:{"--value":t}})})};let o=e=>{let{player:a}=e;return(0,i.useEffect)(()=>()=>{},[a]),(0,s.jsx)(s.Fragment,{children:a.data.song.name&&a.data.song.artist.name?(0,s.jsxs)("div",{className:"music-information",children:[(0,s.jsx)(n,{player:a}),(0,s.jsxs)("div",{className:"music-information__layout",children:[(0,s.jsx)("p",{className:"music-information__song-name fontsize__body",children:a.data.song.name}),(0,s.jsxs)("p",{className:"music-information__artist-name fontsize__caption",children:[(0,s.jsx)("span",{children:"by "}),a.data.song.artist.name]})]})]}):(0,s.jsx)("div",{children:"aaa"})})},l=e=>{let[a,t]=(0,i.useState)("stop");return(0,i.useEffect)(()=>{if(!e)return;let a={onPlay:()=>t("play"),onPause:()=>t("pause")};return e.addListener(a),()=>{e.removeListener(a)}},[e]),{togglePlayPause:(0,i.useCallback)(()=>{e&&("play"===a?e.requestPause():e.requestPlay())},[e,a]),status:a}};var c=t(5889),u=e=>{let{onAliveChange:a}=e,t="State Machine 1",{rive:r,RiveComponent:n}=(0,c.useRive)({src:"/images/mikuanimation.riv",autoplay:!0,stateMachines:t,artboard:"Aliving"}),o=(0,c.useStateMachineInput)(r,t,"Alive");return(0,i.useEffect)(()=>{o&&"number"==typeof o.value&&a(o.value)},[o,a]),(0,s.jsx)("div",{children:(0,s.jsx)(n,{className:"aliving-button"})})},d=()=>{let{rive:e,RiveComponent:a}=(0,c.useRive)({src:"/images/mikuanimation.riv",autoplay:!0,stateMachines:"State Machine 1",artboard:"Heart"});return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{className:"heart",children:(0,s.jsx)(a,{className:"heart__size"})})})};let m=e=>{let{setTextVolume:a,setMusicVolume:t,player:i,setMikuValue:r,setPrevMikuValue:n,status:o}=e,l=(e,s,l)=>{a(e),t(s),i&&(i.volume=s),"play"===o?r(l):(n(l),r(0))};return(0,s.jsx)("div",{className:"aliving-control fontsize__caption",children:(0,s.jsxs)("div",{className:"aliving-control__interaction",children:[(0,s.jsx)(d,{}),(0,s.jsx)(u,{onAliveChange:e=>{3===e?l(1,0,3):2===e?l(.8,20,2):1===e&&l(0,60,1)}})]})})},g=e=>{let{mikuValue:a}=e,t="State Machine 1",{rive:i,RiveComponent:r}=(0,c.useRive)({src:"/images/mikuanimation.riv",autoplay:!0,stateMachines:t,artboard:"MikuAnimation_SP"}),n=(0,c.useStateMachineInput)(i,t,"EmotionAmount");return n&&(n.value=a),(0,s.jsx)("div",{className:"miku-animation",children:(0,s.jsx)("div",{className:"miku-animation__image",children:(0,s.jsx)(r,{})})})};var p=t(2261),h=t(9304);t(889),t(1306),t(9087),t(4158);var v=e=>{let{playPauseValue:a}=e,t="State Machine 1",{rive:i,RiveComponent:r}=(0,c.useRive)({src:"/images/mikuanimation.riv",autoplay:!0,stateMachines:t,artboard:"ControlPlayPause"}),n=(0,c.useStateMachineInput)(i,t,"PlayPauseValue");return n&&(n.value=a),(0,s.jsx)("div",{className:"control-play-pause",children:(0,s.jsx)(r,{})})},y=e=>{let{handleSlideChange:a,handleTogglePlayPause:t,tracks:i,phrase:r=" ",playPauseValue:n}=e;return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{className:"scroll-area",children:(0,s.jsxs)(p.tq,{direction:"vertical",modules:[h.s5,h.Gk,h.tl],slidesPerView:1,spaceBetween:0,mousewheel:{invert:!1,forceToAxis:!0,releaseOnEdges:!0,sensitivity:1},className:"mySwiper",autoHeight:!1,onSlideChange:a,loop:!0,pagination:{clickable:!0,el:".swiper-pagination",type:"bullets"},children:[(0,s.jsx)("div",{className:"swiper-pagination"}),i.map(e=>(0,s.jsxs)(p.o5,{children:[(0,s.jsx)("div",{className:"control-play-pause__button-layout",children:(0,s.jsx)("button",{className:"control-play-pause__button-layout",onClick:()=>{console.log("Swiper clicked"),t()},children:(0,s.jsx)(v,{playPauseValue:n})})}),(0,s.jsx)("div",{className:"lyrics__layout",children:(0,s.jsx)("p",{className:"fontsize__lyrics lyrics",children:r})})]},e.url))]})})})},x=()=>{let{RiveComponent:e}=(0,c.useRive)({src:"/images/mikuanimation.riv",autoplay:!0,stateMachines:"State Machine 1",artboard:"Loading"});return(0,s.jsxs)("div",{className:"loading",children:[(0,s.jsxs)("div",{className:"loading__animation__layout",children:[(0,s.jsx)("div",{className:"triangle__top"}),(0,s.jsx)(e,{className:"loading__animation"}),(0,s.jsxs)("span",{className:"fontsize__body loading__accent",children:["上下スワイプ",(0,s.jsx)("span",{className:"loading__text",children:"で楽曲切り替え"})]}),(0,s.jsx)("div",{className:"triangle__bottom"})]}),(0,s.jsx)("span",{className:"loading__font fontsize__body",children:"LOADING..."})]})};let _=[{url:"https://piapro.jp/t/--OD/20240202150903",options:{video:{beatId:4592296,chordId:2727636,repetitiveSegmentId:2824327,lyricId:59416,lyricDiffId:13963}},background:"/images/bg-mirai.png",backgroundPC:"/images/bg-mirai-PC.png"},{url:"https://piapro.jp/t/XiaI/20240201203346",options:{video:{beatId:4592297,chordId:2727637,repetitiveSegmentId:2824328,lyricId:59417,lyricDiffId:13964}},background:"/images/bg-future.png",backgroundPC:"/images/bg-future-PC.png"},{url:"https://piapro.jp/t/Rejk/20240202164429",options:{video:{beatId:4592298,chordId:2727638,repetitiveSegmentId:2824329,lyricId:59418,lyricDiffId:13965}},background:"/images/bg-koushin.png",backgroundPC:"/images/bg-koushin-PC.png"},{url:"https://piapro.jp/t/hZ35/20240130103028",options:{video:{beatId:4592293,chordId:2727635,repetitiveSegmentId:2824326,lyricId:59415,lyricDiffId:13962}},background:"/images/bg-hero.png",backgroundPC:"/images/bg-hero-PC.png"},{url:"https://piapro.jp/t/ELIC/20240130010349",options:{video:{beatId:4592299,chordId:2727639,repetitiveSegmentId:2824330,lyricId:59419,lyricDiffId:13966}},background:"",backgroundPC:"/images/bg-reality-PC.png"},{url:"https://piapro.jp/t/xEA7/20240202002556",options:{video:{beatId:4592300,chordId:2727640,repetitiveSegmentId:2824331,lyricId:59420,lyricDiffId:13967}},background:"/images/bg-marks.png",backgroundPC:"/images/bg-marks-PC.png"}];var j=e=>{let{setCurrentTrackIndex:a}=e,[t,n]=(0,i.useState)(null),[c,u]=(0,i.useState)(""),[d,p]=(0,i.useState)(""),[h,v]=(0,i.useState)(""),[j,b]=(0,i.useState)(0),[k,f]=(0,i.useState)(60),[I,P]=(0,i.useState)(0),[S,N]=(0,i.useState)(1),[C,M]=(0,i.useState)(0),[E,w]=(0,i.useState)(0),{togglePlayPause:V,status:T}=l(t);(0,i.useEffect)(()=>{let e=new r.J5({app:{token:"YI8I8mIpotidyyxf"}});e.createFromSongUrl(_[0].url).catch(e=>{console.error("Error initializing track:",e)});let a={onTimerReady:()=>{z(e),A(e),n(e),console.log("Player is ready")}};return e.addListener(a),()=>{console.log("--- [player] shutdown ---"),e.removeListener(a)}},[]);let z=e=>{var a;let t=null===(a=e.video)||void 0===a?void 0:a.firstWord;for(;t&&t.next;)t.animate=(e,a)=>{a.startTime<=e&&a.endTime>e&&c!==a.text&&u(a.text)},t=t.next},A=e=>{var a;let t=null===(a=e.video)||void 0===a?void 0:a.firstPhrase;for(;t&&t.next;)t.animate=(e,a)=>{a.startTime<=e&&a.endTime>e&&c!==a.text&&p(a.text)},t=t.next},L=e=>{let a=new SpeechSynthesisUtterance(e);a.lang="ja-JP",a.volume=j,a.rate=1.5,a.onerror=e=>{console.error("Speech synthesis error:",e.error)};try{speechSynthesis.speak(a)}catch(e){console.error("Error in speech synthesis:",e)}};return(0,i.useEffect)(()=>{(async()=>{if(t&&void 0!==I)try{await t.createFromSongUrl(_[I].url,_[I].options).catch(e=>{console.error("Error loading track:",e),alert("トラックの読み込みに失敗しました。再試行してください。")}),t.requestStop(),p(" "),u(" "),0!==S&&M(S),N(0),w(0),console.log("preMikuValue",C)}catch(e){console.error("Error loading track:",e)}})()},[I,t]),(0,i.useEffect)(()=>{c&&c!==h&&(j>=.8&&L(c),v(c))},[h,c]),(0,s.jsx)(s.Fragment,{children:t?(0,s.jsxs)("div",{className:"control-area",style:{backgroundImage:"url(".concat(_[I].background,")")},children:[(0,s.jsx)(g,{mikuValue:S}),(0,s.jsx)(m,{setTextVolume:b,setMusicVolume:f,player:t,setMikuValue:N,setPrevMikuValue:M,status:T}),(0,s.jsx)(o,{player:t}),(0,s.jsx)(y,{handleSlideChange:e=>{P(e.realIndex),a(e.realIndex)},handleTogglePlayPause:()=>{"play"===T?(M(S),N(0),w(2),console.log("PlayPauseValue",E),console.log("MikuValue",S),console.log("preMikuValue",C),t&&t.requestPause()):("pause"===T||"stop"===T)&&(N(C),w(1),console.log("PlayPauseValue",E),console.log("MikuValue",S),console.log("preMikuValue",C),t&&t.requestPlay()),V()},tracks:_,phrase:d,playPauseValue:E})]}):(0,s.jsx)(x,{})})},b=()=>{let[e,a]=(0,i.useState)(0);return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{className:"layout__background",style:{backgroundImage:"url(".concat(_[e].backgroundPC,")"),backgroundAttachment:"fixed",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundSize:"cover"},children:(0,s.jsx)("div",{className:"layout__control-area",children:(0,s.jsx)(j,{setCurrentTrackIndex:a})})})})},k=()=>(0,s.jsx)("div",{children:(0,s.jsx)(b,{})})}},function(e){e.O(0,[461,887,608,888,774,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);